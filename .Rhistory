similarity_cutoff = params$cutoff,
plot_final = plot_maps))
pavo_scores <- suppressMessages(lapply(recluster_fits,
function(i) recolorize_adjacency(i)))
plot(recluster_fits[[5]])
recolorize_adjacency(recluster_fits[[5]])
?pavo::adjacent
papilio <- getimg(system.file("testdata/images/papilio.png", package = "pavo"))
library(pavo)
papilio <- getimg(system.file("testdata/images/papilio.png", package = "pavo"))
papilio_class <- classify(papilio, kcols = 2)
plot(papilio_class)
attr(papilio_class, "k")
attr(papilio_class, "classRGB")
papilio_adj <- adjacent(papilio_class, xscale = 100, bkgID = 1)
papilio_adj
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
#ylim = c(-0.05, 1.05),
main = "")
graphics::rect(0, 0, 1, 1,
border = grDevices::rgb(centers[i, 1],
centers[i, 2],
centers[i, 3]),
lwd = 8,
ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
centers <- recolorize_obj$centers
centers
recolorize_obj <- recolorize(img)
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
#ylim = c(-0.05, 1.05),
main = "")
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
#ylim = c(-0.05, 1.05),
main = "")
graphics::rect(0, 0, 1, 1,
border = grDevices::rgb(centers[i, 1],
centers[i, 2],
centers[i, 3]),
lwd = 8,
ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
layout(matrix(1:8, nrow = 2))
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
#ylim = c(-0.05, 1.05),
main = "")
graphics::rect(0, 0, 1, 1,
border = grDevices::rgb(centers[i, 1],
centers[i, 2],
centers[i, 3]),
lwd = 8,
ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
xlim = c(-0.05, 1.05),
ylim = c(-0.05, 1.05),
main = "")
graphics::rect(0, 0, 1, 1,
border = grDevices::rgb(centers[i, 1],
centers[i, 2],
centers[i, 3]),
lwd = 8,
ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1.1),
main = "")
graphics::rect(0, 0, 1, 1,
border = grDevices::rgb(centers[i, 1],
centers[i, 2],
centers[i, 3]),
lwd = 8,
ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1.1),
main = "")
# graphics::rect(0, 0, 1, 1,
#                border = grDevices::rgb(centers[i, 1],
#                                        centers[i, 2],
#                                        centers[i, 3]),
#                lwd = 8,
#                ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
# plot as binary map
for (i in 1:length(color_masks)) {
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1),
main = "")
# graphics::rect(0, 0, 1, 1,
#                border = grDevices::rgb(centers[i, 1],
#                                        centers[i, 2],
#                                        centers[i, 3]),
#                lwd = 8,
#                ljoin = 3)
# rect(-0.1, 0, 0, 1.,
#      col = rgb(centers[i, 1],
#                   centers[i, 2],
#                   centers[i, 3]),
#      border = NA, lwd = 5)
}
graphics::rect(0, 1, 1, 1.1,
col = "red")
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1.1),
main = "")
graphics::rect(0, 1, 1, 1.1,
col = "red")
graphics::rect(0, 1, 1, 1.1,
col = "red", border = "red")
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1.1),
main = "")
graphics::rect(0, 1, 1, 1.1,
col = "red", border = "red")
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1.2),
main = "")
graphics::rect(0, 1, 1, 1.2,
col = "red", border = "red")
plotImageArray(color_masks[[i]],
#xlim = c(-0.05, 1.05),
ylim = c(0, 1.15),
main = "")
graphics::rect(0, 1, 1, 1.15,
col = "red", border = "red")
text(0.5, 1.07, "1")
text(0.5, 1, "1")
text(0.5, 1.05, "1")
install.packages("fishtree")
family_tree <- fishtree::fishtree_phylogeny(rank = "Family")
family_tree <- fishtree::fishtree_phylogeny(rank = "family")
?fishtree:fishtree_phylogeny
?fishtree::fishtree_phylogeny
fishtree::fishtree_taxonomy()
family_tree <- fishtree::fishtree_taxonomy()$rank == 'family'
family_tree
library(fishtree)
family_tree <- fishtree_taxonomy[which(fishtree_taxonomy()$rank == 'family'), ]
library(fishtree)
family_groups <- fishtree_taxonomy()[which(fishtree_taxonomy()$rank == 'family'), ]
family_tree <- fishtree_phylogeny(rank = family_groups)
family_tree <- fishtree_phylogeny(rank = family_groups$name)
plot(fishtree_phylogeny())
tree <- fishtree_phylogeny()
tree <- fishtree_phylogeny()
library(phytools)
library(phytools)
tree <- fishtree_phylogeny()
pdf("../../mouthbrooding/phylogeny/fishtree_chang2019.pdf",
height = 100, width = 10)
plot(tree, cex = 0.5)
nodelabels(cex = 0.5)
dev.off()
family_groups <- fishtree_taxonomy()[which(fishtree_taxonomy()$rank == 'family'), ]
family_groups$name
fishtree_taxonomy()
?fitPagel
x <- seq(0, 1, length.out = 1000)
y_subs <- -x + 0.3
y_mb <- -0.8*x + 0.3
y_winn <- -0.8*x + 0.6
plot(x, y_subs, col = "darkgrey", type = "l")
points(x, y_mb, col = "goldenrod1", type = "l")
y_subs <- -x + 1
y_mb <- -0.8*x + 0.3
y_winn <- -0.8*x + 0.6
plot(x, y_subs, col = "darkgrey", type = "l")
points(x, y_mb, col = "goldenrod1", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.2*x + 0.3
y_winn <- -0.8*x + 0.6
plot(x, y_subs, col = "darkgrey", type = "l")
points(x, y_mb, col = "goldenrod1", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.2*x + 0.5
y_winn <- -0.2*x + 0.8
plot(x, y_subs, col = "darkgrey", type = "l")
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(1/3, 2/3))
abline(v = c(0.3, 0.65))
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.65))
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7))
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
.3/.7
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.3/0.7*x + 0.4 # (0, 0) and (0.7, 0.3)
y_winn <- -0.2*x + 0.8 # (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
y_mb <- -0.3/0.7*x # (0, 0) and (0.7, 0.3)
points(x, y_mb, col = "goldenrod1", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- -0.2*x + 0.8 # (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
y_winn <- -0.1/0.3*x + 0.8 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
y_winn <- -0.1/0.7*x + 0.8 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- -0.1/0.7*x + 0.7 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- -0.1/0.7*x + 0.65 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- -0.1/0.7*x + 0.75 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- -0.1/0.7*x + 0.74 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- y_mb + 0.4
#-0.1/0.7*x + 0.74 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- y_mb + 0.3
#-0.1/0.7*x + 0.74 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- -0.1/0.7*x + 0.4 # (0, 0.4) and (0.7, 0.3)
y_winn <- y_mb + 0.34
#-0.1/0.7*x + 0.74 # (0, 0.6) and (0.3, 0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
-0.1/0.7
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, -0.1/0.7)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
-0.1/0.7
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
0.4 - 0.1/0.7
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.4
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(1, 1 - 0.1/0.7)
y_winn <- c(0.8)
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "green", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
0.4 - 0.1/0.7
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "darkblue", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
polygon(x = c(0, 0.3, 0.3, 0),
y = c(0, 0, 1, 1),
col = "lightgrey")
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "darkblue", type = "l")
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(0, 0, 1.1, 1.1),
col = "lightgrey")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "darkblue", type = "l")
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = "lightgrey")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = grey(0.2, alpha = 0.2))
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "darkblue", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = grey(0.8, alpha = 0.2))
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "darkblue", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "l")
abline(v = c(0.3, 0.7), lty = 2)
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = grey(0.8, alpha = 0.5))
points(x, y_mb, col = "goldenrod1", type = "l")
points(x, y_winn, col = "darkblue", type = "l")
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, col = "darkgrey", type = "n")
abline(v = c(0.3, 0.7), lty = 2)
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = grey(0.8, alpha = 0.5))
point(x, y_sub, col = "darkgrey", type = "l", lwd = 5)
points(x, y_mb, col = "goldenrod1", type = "l", lwd = 5)
points(x, y_winn, col = "darkblue", type = "l", lwd = 5)
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, type = "n")
abline(v = c(0.3, 0.7), lty = 2)
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = grey(0.8, alpha = 0.5))
point(x, y_subs, col = "darkgrey", type = "l", lwd = 5)
points(x, y_mb, col = "goldenrod1", type = "l", lwd = 5)
points(x, y_winn, col = "darkblue", type = "l", lwd = 5)
points(0.3, 0.7)
points(0.7, 0.3)
x <- c(0, 1)
y_subs <- c(1, 0)
y_mb <- c(0.4, 0.4 - 0.1/0.7)
y_winn <- y_mb + 0.34
plot(x, y_subs, type = "n")
abline(v = c(0.3, 0.7), lty = 2)
polygon(x = c(-1, 0.3, 0.3, -1),
y = c(-.1, -0.1, 1.1, 1.1),
col = grey(0.8, alpha = 0.5))
points(x, y_subs, col = "darkgrey", type = "l", lwd = 5)
points(x, y_mb, col = "goldenrod1", type = "l", lwd = 5)
points(x, y_winn, col = "darkblue", type = "l", lwd = 5)
points(0.3, 0.7)
points(0.7, 0.3)
