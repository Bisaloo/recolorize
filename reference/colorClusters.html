<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generate color clusters from an image — colorClusters • recolorize</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generate color clusters from an image — colorClusters"><meta property="og:description" content="Clusters all the pixels in an image according to the specified method and
returns color centers, cluster assignments, and cluster sizes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">recolorize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/step00_prep.html">Step 0: Image acquisition and preparation</a>
    </li>
    <li>
      <a href="../articles/step01_loading.html">Step 1: Loading &amp; processing images</a>
    </li>
    <li>
      <a href="../articles/step02_initial_cluster.html">Step 2: Initial clustering</a>
    </li>
    <li>
      <a href="../articles/step03_refinement.html">Step 3: Refinement</a>
    </li>
    <li>
      <a href="../articles/step04_manual_tweak.html">Step 4: Tweaks &amp; edits</a>
    </li>
    <li>
      <a href="../articles/step05_visualization_export.html">Step 5: Exporting &amp; visualizing output</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate color clusters from an image</h1>
    
    <div class="hidden name"><code>colorClusters.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Clusters all the pixels in an image according to the specified method and
returns color centers, cluster assignments, and cluster sizes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">colorClusters</span><span class="op">(</span>
  <span class="va">bg_indexed</span>,
  method <span class="op">=</span> <span class="st">"histogram"</span>,
  n <span class="op">=</span> <span class="fl">10</span>,
  bins <span class="op">=</span> <span class="fl">3</span>,
  color_space <span class="op">=</span> <span class="st">"Lab"</span>,
  ref_white <span class="op">=</span> <span class="st">"D65"</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>bg_indexed</dt>
<dd><p>A list returned by <code><a href="backgroundIndex.html">backgroundIndex</a></code>.</p></dd>
<dt>method</dt>
<dd><p>Binning scheme to use, one of either <code>kmeans</code> or <code>histogram</code>.
Produce very different results (see details).</p></dd>
<dt>n</dt>
<dd><p>If <code>method = "kmeans"</code>, the number of colors to fit.</p></dd>
<dt>bins</dt>
<dd><p>If <code>method = "histogram"</code>, either the number of bins per color
channel (if a single number is provided) OR a vector of length 3 with the
number of bins for each channel.</p></dd>
<dt>color_space</dt>
<dd><p>Color space in which to cluster colors, passed to
<code><a href="https://rdrr.io/r/grDevices/grDevices-package.html" class="external-link">grDevices</a>{convertColor}</code>. One of "sRGB", "Lab", or "Luv".
Default is "Lab", a perceptually uniform (for humans) color space.</p></dd>
<dt>ref_white</dt>
<dd><p>Reference white for converting to different color spaces.
D65 (the default) corresponds to standard daylight.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with the following elements:</p><ol><li><p><code>pixel_assignments</code>: A vector of color center assignments for
each pixel.</p></li>
<li><p><code>centers</code>: A matrix of color centers, in RGB color space.</p></li>
<li><p><code>sizes</code>: The number of pixels assigned to each cluster.</p></li>
</ol></div>
    <div id="details">
    <h2>Details</h2>
    <p><code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans</a></code> clustering tries to find the set of <code>n</code> clusters
that minimize overall distances. Histogram binning divides up color space
according to set breaks; for example, bins = 2 would divide the red, green,
and blue channels into 2 bins each (&gt; 0.5 and &lt; 0 .5), resulting in 8
possible ranges. A white pixel (RGB = 1, 1, 1) would fall into the R \&gt; 0.5, G
\&gt; 0.5, B \&gt; 0.5 bin. The resulting centers represent the average color of all
the pixels assigned to that bin.</p>
<p>K-means clustering can produce more intuitive results, but because it is
iterative, it will find slightly different clusters each time it is run, and
their order will be arbitrary. It also tends to divide up similar colors that
make up the majority of the image. Histogram binning will produce the same
results every time, in the same order, and because it forces the bins to be
dispersed throughout color space, tends to better pick up small color
details. Bins are also comparable across images. However, this sometimes
means returning empty bins (i.e. the white bin will be empty if clustering a
very dark image).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># make a 100x100 'image' of random colors</span></span>
<span class="r-in"><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">30000</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotImageArray.html">plotImageArray</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span class="r-plt img"><img src="colorClusters-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># make a background index object:</span></span>
<span class="r-in"><span class="va">bg_indexed</span> <span class="op">&lt;-</span> <span class="fu"><a href="backgroundIndex.html">backgroundIndex</a></span><span class="op">(</span><span class="va">img</span>, <span class="fu"><a href="backgroundCondition.html">backgroundCondition</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No pixels satisfying masking conditions; clustering all pixels</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># histogram clustering</span></span>
<span class="r-in"><span class="va">hist_clusters</span> <span class="op">&lt;-</span> <span class="fu">colorClusters</span><span class="op">(</span><span class="va">bg_indexed</span>, method <span class="op">=</span> <span class="st">"hist"</span>, bins <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 2^3 = 8 total bins</span>
<span class="r-in"><span class="fu"><a href="plotColorPalette.html">plotColorPalette</a></span><span class="op">(</span><span class="va">hist_clusters</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span class="r-plt img"><img src="colorClusters-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># we can use a different number of bins for each channel</span></span>
<span class="r-in"><span class="va">uneven_clusters</span> <span class="op">&lt;-</span> <span class="fu">colorClusters</span><span class="op">(</span><span class="va">bg_indexed</span>, method <span class="op">=</span> <span class="st">"hist"</span>,</span>
<span class="r-in">                                 bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using 3*2*1 = 6 bins</span>
<span class="r-in"><span class="fu"><a href="plotColorPalette.html">plotColorPalette</a></span><span class="op">(</span><span class="va">uneven_clusters</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span class="r-plt img"><img src="colorClusters-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># using kmeans</span></span>
<span class="r-in"><span class="va">kmeans_clusters</span> <span class="op">&lt;-</span> <span class="fu">colorClusters</span><span class="op">(</span><span class="va">bg_indexed</span>, method <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span class="r-in">                                 n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotColorPalette.html">plotColorPalette</a></span><span class="op">(</span><span class="va">kmeans_clusters</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span></span>
<span class="r-plt img"><img src="colorClusters-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hannah Weller.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

